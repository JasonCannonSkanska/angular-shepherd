{"version":3,"file":"angular-shepherd.mjs","sources":["../../../repos/angular-shepherd/src/lib/utils/dom.ts","../../../repos/angular-shepherd/src/lib/utils/buttons.ts","../../../repos/angular-shepherd/src/lib/shepherd.service.ts","../../../repos/angular-shepherd/src/public_api.ts","../../../repos/angular-shepherd/src/angular-shepherd.ts"],"sourcesContent":["/**\r\n * Helper method to check if element is hidden, since we cannot use :visible without jQuery\r\n * @param element The element to check for visibility\r\n * @returns true if element is hidden\r\n */\r\nexport function elementIsHidden(element: HTMLElement): boolean {\r\n  return element.offsetWidth === 0 && element.offsetHeight === 0;\r\n}\r\n","import type { StepOptionsButton } from 'shepherd.js';\r\nimport type { ShepherdService } from '../shepherd.service';\r\n\r\nexport type AngularShepherdButton = StepOptionsButton & {\r\n  type?: 'back' | 'cancel' | 'next';\r\n};\r\n\r\n/**\r\n * Creates a button of the specified type, with the given classes and text\r\n *\r\n * @param button.type The type of button cancel, back, or next\r\n * @param button.classes Classes to apply to the button\r\n * @param button.text The text for the button\r\n * @param button.action The action to call\r\n */\r\nexport function makeButton(\r\n  this: ShepherdService,\r\n  button: AngularShepherdButton\r\n) {\r\n  const { classes, disabled, label, secondary, type, text } = button;\r\n  const builtInButtonTypes = ['back', 'cancel', 'next'];\r\n\r\n  if (!type) {\r\n    return button;\r\n  }\r\n\r\n  if (builtInButtonTypes.indexOf(type) === -1) {\r\n    throw new Error(\r\n      `'type' property must be one of 'back', 'cancel', or 'next'`\r\n    );\r\n  }\r\n\r\n  return {\r\n    action: this[type].bind(this),\r\n    classes,\r\n    disabled,\r\n    label,\r\n    secondary,\r\n    text\r\n  };\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport Shepherd, {\r\n  type TourOptions,\r\n  type StepOptions,\r\n  type Tour\r\n} from 'shepherd.js';\r\nimport { elementIsHidden } from './utils/dom';\r\nimport { makeButton } from './utils/buttons';\r\n\r\ninterface RequiredElement {\r\n  message: string;\r\n  selector: string;\r\n  title: string;\r\n}\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ShepherdService {\r\n  confirmCancel: TourOptions['confirmCancel'] = false;\r\n  confirmCancelMessage?: TourOptions['confirmCancelMessage'];\r\n  defaultStepOptions: StepOptions = {};\r\n  errorTitle?: string;\r\n  exitOnEsc: TourOptions['exitOnEsc'] = true;\r\n  isActive = false;\r\n  keyboardNavigation: TourOptions['keyboardNavigation'] = true;\r\n  messageForUser: string | null = null;\r\n  modal = false;\r\n  requiredElements: Array<RequiredElement> = [];\r\n  tourName: TourOptions['tourName'] = undefined;\r\n  tourObject: Tour | null = null;\r\n\r\n  constructor() {}\r\n\r\n  /**\r\n   * Get the tour object and call back\r\n   */\r\n  back() {\r\n    this.tourObject?.back();\r\n  }\r\n\r\n  /**\r\n   * Cancel the tour\r\n   */\r\n  cancel() {\r\n    this.tourObject?.cancel();\r\n  }\r\n\r\n  /**\r\n   * Complete the tour\r\n   */\r\n  complete() {\r\n    this.tourObject?.complete();\r\n  }\r\n\r\n  /**\r\n   * Hides the current step\r\n   */\r\n  hide() {\r\n    this.tourObject?.hide();\r\n  }\r\n\r\n  /**\r\n   * Advance the tour to the next step\r\n   */\r\n  next() {\r\n    this.tourObject?.next();\r\n  }\r\n\r\n  /**\r\n   * Show a specific step, by passing its id\r\n   * @param id The id of the step you want to show\r\n   */\r\n  show(id: string | number) {\r\n    this.tourObject?.show(id);\r\n  }\r\n\r\n  /**\r\n   * Start the tour\r\n   */\r\n  start() {\r\n    this.isActive = true;\r\n    this.tourObject?.start();\r\n  }\r\n\r\n  /**\r\n   * This function is called when a tour is completed or cancelled to initiate cleanup.\r\n   * @param completeOrCancel 'complete' or 'cancel'\r\n   */\r\n  onTourFinish(completeOrCancel: string) {\r\n    this.isActive = false;\r\n  }\r\n\r\n  /**\r\n   * Take a set of steps and create a tour object based on the current configuration\r\n   * @param steps An array of steps\r\n   */\r\n  addSteps(steps: Array<StepOptions>) {\r\n    this._initialize();\r\n    const tour = this.tourObject;\r\n\r\n    // Return nothing if there are no steps or if somehow there is no tour.\r\n    if (!tour || !steps || !Array.isArray(steps) || steps.length === 0) {\r\n      return;\r\n    }\r\n\r\n    if (!this.requiredElementsPresent()) {\r\n      tour.addStep({\r\n        buttons: [\r\n          {\r\n            text: 'Exit',\r\n            action: tour.cancel\r\n          }\r\n        ],\r\n        id: 'error',\r\n        title: this.errorTitle,\r\n        text: [this.messageForUser as string]\r\n      });\r\n      return;\r\n    }\r\n\r\n    steps.forEach((step) => {\r\n      if (step.buttons) {\r\n        step.buttons = step.buttons.map(makeButton.bind(this), this);\r\n      }\r\n\r\n      tour.addStep(step);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Observes the array of requiredElements, which are the elements that must be present at the start of the tour,\r\n   * and determines if they exist, and are visible, if either is false, it will stop the tour from executing.\r\n   */\r\n  private requiredElementsPresent() {\r\n    let allElementsPresent = true;\r\n\r\n    /* istanbul ignore next: also can't test this due to things attached to root blowing up tests */\r\n    this.requiredElements.forEach((element) => {\r\n      const selectedElement = document.querySelector(element.selector);\r\n\r\n      if (\r\n        allElementsPresent &&\r\n        (!selectedElement || elementIsHidden(selectedElement as HTMLElement))\r\n      ) {\r\n        allElementsPresent = false;\r\n        this.errorTitle = element.title;\r\n        this.messageForUser = element.message;\r\n      }\r\n    });\r\n\r\n    return allElementsPresent;\r\n  }\r\n\r\n  /**\r\n   * Initializes the tour, creates a new Shepherd.Tour. sets options, and binds events\r\n   */\r\n  private _initialize() {\r\n    const tourObject = new Shepherd.Tour({\r\n      confirmCancel: this.confirmCancel,\r\n      confirmCancelMessage: this.confirmCancelMessage,\r\n      defaultStepOptions: this.defaultStepOptions,\r\n      keyboardNavigation: this.keyboardNavigation,\r\n      tourName: this.tourName,\r\n      useModalOverlay: this.modal,\r\n      exitOnEsc: this.exitOnEsc\r\n    });\r\n\r\n    tourObject.on('complete', this.onTourFinish.bind(this, 'complete'));\r\n    tourObject.on('cancel', this.onTourFinish.bind(this, 'cancel'));\r\n\r\n    this.tourObject = tourObject;\r\n  }\r\n}\r\n","/*\r\n * Public API Surface of shepherd\r\n */\r\n\r\nexport * from './lib/shepherd.service';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}